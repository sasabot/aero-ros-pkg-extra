<launch>
  <arg name="dummy" default="false" />
  <arg name="image" default="/stereo/left/image_rect_color" />
  <arg name="gpu" default="0"/>
  <!-- detector params -->
  <arg name="score_thresh" default="0.75"/>
  <arg name="visualize" default="false" />

  <!-- file paths -->
  <arg name="model" default="container" />
  <!-- <arg name="model" default="fcsc" /> -->

  <!-- object detector -->
  <node pkg="aero_object_detector" type="object_detector_chainer.py"
        name="object_detector" output="screen" unless="$(arg dummy)" respawn="true">
    <remap from="image" to="$(arg image)" />
    <rosparam subst_value="true">
      model_name : $(arg model)
      gpu: $(arg gpu)
      score_thresh: $(arg score_thresh)
      visualize: $(arg visualize)
    </rosparam>
  </node>
  <node pkg="aero_object_detector" type="object_3d_projector" name="object_3d_projector" output="log" respawn="true" unless="$(arg dummy)">
    <remap from="~input_cloud" to="/stereo/points2" />
    <remap from="~input_boxes" to="/object_detector/boxes" />
    <remap from="~input_info" to="/stereo/left/camera_info" />
    <remap from="~input_image" to="/object_detector/image" />
    <rosparam subst_value="true">
      mode : 0
      window_size : 20
      search_step : 10
    </rosparam>
  </node>

  <!-- dummy object detector -->
  <node pkg="aero_object_detector" type="dummy_object_detector.py"
        name="object_detector" if="$(arg dummy)">
    <remap from="image" to="$(arg image)" />
    <rosparam subst_value="true">
      model_name : $(arg model)
      gpu: $(arg gpu)
      score_thresh: $(arg score_thresh)
      visualize: $(arg visualize)
    </rosparam>
  </node>
  <node pkg="aero_object_detector" type="dummy_object_3d_projector" name="object_3d_projector" respawn="true" if="$(arg dummy)">
    <remap from="~input_boxes" to="/object_detector/boxes" />
  </node>
</launch>
